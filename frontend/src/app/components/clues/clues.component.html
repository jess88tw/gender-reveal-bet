<div class="clues-container">
  <header class="page-header">
    <a routerLink="/" class="back-btn">â† è¿”å›</a>
    <h1>ğŸ” ç·šç´¢å¤§å…¬é–‹</h1>
  </header>

  @if (loading()) {
    <div class="loading">
      <div class="spinner"></div>
      <p>è¼‰å…¥ä¸­...</p>
    </div>
  } @else {

    <!-- Symptom Comparison Table -->
    @if (symptoms().length > 0) {
      <div class="symptom-card">
        <div class="symptom-card-header">
          <span class="header-title">Boy</span>
          <span class="header-or">or</span>
          <span class="header-title">Girl?</span>
        </div>

        <div class="symptom-table">
          <div class="table-header">
            <span class="col-boy-header">ğŸ‘¦ ç”·ç”Ÿç‰¹å¾µ</span>
            <span class="col-cat-header">é …ç›®</span>
            <span class="col-girl-header">ğŸ‘§ å¥³ç”Ÿç‰¹å¾µ</span>
          </div>

          @for (symptom of symptoms(); track symptom.id) {
            <div class="table-row">
              <span
                class="col-boy-val"
                [class.checked]="symptom.checkedGender === 'BOY'"
              >
                {{ symptom.boyDescription }}
                @if (symptom.checkedGender === 'BOY') {
                  <span class="check-mark">âœ“</span>
                }
              </span>
              <span class="col-cat-val">{{ symptom.category }}</span>
              <span
                class="col-girl-val"
                [class.checked]="symptom.checkedGender === 'GIRL'"
              >
                @if (symptom.checkedGender === 'GIRL') {
                  <span class="check-mark">âœ“</span>
                }
                {{ symptom.girlDescription }}
              </span>
            </div>
          }
        </div>

        <!-- Score Summary -->
        @if (boyCheckedCount() > 0 || girlCheckedCount() > 0) {
          <div class="score-summary">
            <div class="score-bar">
              <div
                class="score-fill boy"
                [style.flex]="boyCheckedCount()"
              >
                @if (boyCheckedCount() > 0) {
                  ğŸ‘¦ {{ boyCheckedCount() }}
                }
              </div>
              <div
                class="score-fill girl"
                [style.flex]="girlCheckedCount()"
              >
                @if (girlCheckedCount() > 0) {
                  ğŸ‘§ {{ girlCheckedCount() }}
                }
              </div>
            </div>
          </div>
        }

        <!-- Parents' Predictions -->
        @if (dadPrediction() || momPrediction()) {
          <div class="predictions-display">
            @if (dadPrediction()) {
              <span class="pred-tag" [class.boy]="dadPrediction() === 'BOY'" [class.girl]="dadPrediction() === 'GIRL'">
                çˆ¸çˆ¸é æ¸¬ï¼š{{ dadPrediction() === 'BOY' ? 'ğŸ‘¦ ç”·' : 'ğŸ‘§ å¥³' }}
              </span>
            }
            @if (momPrediction()) {
              <span class="pred-tag" [class.boy]="momPrediction() === 'BOY'" [class.girl]="momPrediction() === 'GIRL'">
                åª½åª½é æ¸¬ï¼š{{ momPrediction() === 'BOY' ? 'ğŸ‘¦ ç”·' : 'ğŸ‘§ å¥³' }}
              </span>
            }
          </div>
        }
      </div>
    }

    <!-- Other Clues -->
    @if (clues().length > 0) {
      <h2 class="section-title">ğŸ“ å…¶ä»–ç·šç´¢</h2>
      <div class="clues-grid">
        @for (clue of clues(); track clue.id) {
          <div class="clue-card" (click)="clue.imageUrl && openImage(clue.id)">
            @if (clue.imageUrl) {
              <div class="clue-image">
                <img [src]="clue.imageUrl" [alt]="clue.title" />
              </div>
            } @else {
              <div class="clue-placeholder">
                <span>{{ getClueTypeLabel(clue.clueType).split(" ")[0] }}</span>
              </div>
            }
            <div class="clue-content">
              <span class="clue-type">{{ getClueTypeLabel(clue.clueType) }}</span>
              <h3>{{ clue.title }}</h3>
              @if (clue.description) {
                <p>{{ clue.description }}</p>
              }
            </div>
          </div>
        }
      </div>
    }

    <!-- Empty State -->
    @if (symptoms().length === 0 && clues().length === 0) {
      <div class="empty-state">
        <p>ğŸ”® ç·šç´¢å³å°‡å…¬é–‹ï¼Œæ•¬è«‹æœŸå¾…ï¼</p>
      </div>
    }

    <!-- Image Modal -->
    @if (selectedClue()) {
      <div class="modal-overlay" (click)="closeImage()">
        <div class="modal-content" (click)="$event.stopPropagation()">
          @for (clue of clues(); track clue.id) {
            @if (clue.id === selectedClue() && clue.imageUrl) {
              <img [src]="clue.imageUrl" [alt]="clue.title" />
              <h3>{{ clue.title }}</h3>
              @if (clue.description) {
                <p>{{ clue.description }}</p>
              }
            }
          }
          <button class="close-btn" (click)="closeImage()">âœ•</button>
        </div>
      </div>
    }

    <!-- Navigation -->
    @if (!isRevealed()) {
      <div class="nav-section">
        <a routerLink="/bet" class="btn btn-primary">çœ‹å®Œç·šç´¢ï¼Œç«‹å³ä¸‹æ³¨ï¼</a>
      </div>
    }
  }
</div>
