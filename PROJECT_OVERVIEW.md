# å¯¶å¯¶æ€§åˆ¥æ­æ›‰æ´¾å° - å°ˆæ¡ˆæ¦‚è¦½

## ğŸ¯ å°ˆæ¡ˆç›®æ¨™

å»ºç«‹ä¸€å€‹äº’å‹•å¼ç¶²ç«™,è®“æœ‹å‹å’Œå®¶äººå¯ä»¥ç·šä¸Šä¸‹æ³¨å¯¶å¯¶æ€§åˆ¥,ä¸¦åœ¨æ­æ›‰æ™‚é€²è¡ŒæŠ½çã€‚

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
gender-reveal-bet/
â”œâ”€â”€ backend/                 # Node.js + Express å¾Œç«¯
â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â””â”€â”€ schema.prisma   # è³‡æ–™åº« Schema (MongoDB)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/         # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts    # èªè­‰ç›¸é—œ (Google Identity Services)
â”‚   â”‚   â”‚   â”œâ”€â”€ bets.ts    # ä¸‹æ³¨ç›¸é—œ
â”‚   â”‚   â”‚   â”œâ”€â”€ clues.ts   # ç·šç´¢ç›¸é—œ
â”‚   â”‚   â”‚   â”œâ”€â”€ admin.ts   # ç®¡ç†åŠŸèƒ½
â”‚   â”‚   â”‚   â””â”€â”€ config.ts  # å…¬é–‹è¨­å®š API
â”‚   â”‚   â”œâ”€â”€ middleware/     # ä¸­é–“ä»¶ (auth, admin)
â”‚   â”‚   â”œâ”€â”€ lib/           # å·¥å…·å‡½å¼ (prisma client)
â”‚   â”‚   â””â”€â”€ index.ts       # ä¸»ç¨‹å¼
â”‚   â”œâ”€â”€ .env.example        # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ frontend/               # Angular 17 å‰ç«¯ (Standalone)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/  # UI å…ƒä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ home/           # é¦–é  (çµ±è¨ˆé¡¯ç¤º)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ betting/        # ä¸‹æ³¨é é¢
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ my-bets/        # æˆ‘çš„ä¸‹æ³¨è¨˜éŒ„
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ clues/          # ç·šç´¢é é¢
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ participants/   # åƒèˆ‡è€…åˆ—è¡¨
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ admin/          # ç®¡ç†å¾Œå°
â”‚   â”‚   â”‚   â”œâ”€â”€ services/    # API æœå‹™ (ä½¿ç”¨ signals)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ config.service.ts  # çµ±ä¸€è¨­å®š (APP_INITIALIZER)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ bet.service.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ clue.service.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ admin.service.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ models/      # è³‡æ–™æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ app.routes.ts # è·¯ç”±è¨­å®š (lazy loading)
â”‚   â”‚   â””â”€â”€ environments/    # ç’°å¢ƒè¨­å®š (åƒ… apiUrl)
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ README.md               # å°ˆæ¡ˆèªªæ˜
â”œâ”€â”€ DEVELOPMENT.md          # é–‹ç™¼æŒ‡å—
â”œâ”€â”€ DEPLOYMENT.md           # éƒ¨ç½²æŒ‡å—
â””â”€â”€ PROJECT_OVERVIEW.md     # æœ¬æ–‡ä»¶
```

## âš™ï¸ è¨­å®šç®¡ç†æ¶æ§‹

æ‰€æœ‰å€‹äººåŒ–è¨­å®šçµ±ä¸€åœ¨ `backend/.env`ï¼ˆå·²è¢« .gitignore å¿½ç•¥ï¼‰ï¼š

```
backend/.env  â”€â”€â†’  GET /api/config  â”€â”€â†’  å‰ç«¯ ConfigService (APP_INITIALIZER)
                   (åªå›å‚³éæ•æ„Ÿè³‡æ–™)       â†“
                                      auth.service.ts (Google Client ID, Admin Emails)
                                      auth.ts middleware (Admin Emails)
```

å‰ç«¯ä¸éœ€è¦åœ¨ `environment.ts` ä¸­è¨­å®šå€‹äººåŒ–è³‡è¨Šï¼Œä¸€åˆ‡å¾å¾Œç«¯å‹•æ…‹è¼‰å…¥ã€‚

## âœ… å·²å®ŒæˆåŠŸèƒ½

### å¾Œç«¯ API

- âœ… ä½¿ç”¨è€…èªè­‰ (Google Identity Services â€” ID Token é©—è­‰)
- âœ… çµ±ä¸€è¨­å®š API (`GET /api/config` â€” å›å‚³ googleClientId + adminEmails)
- âœ… ä¸‹æ³¨ç³»çµ±
  - æ¯äººé™ä¸‹ä¸€æ³¨ï¼ˆNT$200ï¼Œç”·ç”Ÿæˆ–å¥³ç”Ÿæ“‡ä¸€ï¼‰
  - æŸ¥è©¢å€‹äººä¸‹æ³¨è¨˜éŒ„
  - æŸ¥è©¢çµ±è¨ˆè³‡è¨Š
  - åƒèˆ‡è€…åˆ—è¡¨
- âœ… ç·šç´¢ç®¡ç†
  - CRUD æ“ä½œ
- âœ… ç®¡ç†åŠŸèƒ½
  - æŸ¥çœ‹æ‰€æœ‰ä¸‹æ³¨ / ä»˜æ¬¾ç¢ºèª
  - æ€§åˆ¥æ­æ›‰
  - æŠ½çç³»çµ±ï¼ˆçŒœå°è€…ä¸­æŠ½ä¸€ä½ï¼Œçé‡‘æ‰£ 10% æ‰‹çºŒè²»ï¼‰
  - æ¸…ç©ºè³‡æ–™ï¼ˆé–‹ç™¼ç”¨ï¼‰

### å‰ç«¯ä»‹é¢

- âœ… é¦–é  (`home.component`) - çµ±è¨ˆé¡¯ç¤º + ç®¡ç†å“¡å…¥å£
- âœ… ä¸‹æ³¨é é¢ (`betting.component`) - é¸æ“‡æ€§åˆ¥ï¼Œå›ºå®š NT$200
- âœ… æˆ‘çš„ä¸‹æ³¨ (`my-bets.component`) - å€‹äººä¸‹æ³¨è¨˜éŒ„ + ä»˜æ¬¾ç‹€æ…‹
- âœ… ç·šç´¢é é¢ (`clues.component`) - é¡¯ç¤ºæ‰€æœ‰ç·šç´¢
- âœ… åƒèˆ‡è€…åˆ—è¡¨ (`participants.component`) - é¡¯ç¤ºæ€§åˆ¥é¸æ“‡
- âœ… ç®¡ç†å¾Œå° (`admin.component`) - ä»˜æ¬¾ç¢ºèªã€æ­æ›‰ã€æŠ½çã€æ¸…é™¤è³‡æ–™

### å‰ç«¯æœå‹™

- âœ… è¨­å®šæœå‹™ (`config.service.ts`) - å•Ÿå‹•æ™‚å¾å¾Œç«¯è¼‰å…¥è¨­å®šï¼Œä½¿ç”¨ `APP_INITIALIZER`
- âœ… èªè­‰æœå‹™ (`auth.service.ts`) - Google GIS ç™»å…¥ï¼Œä½¿ç”¨ signals
- âœ… ä¸‹æ³¨æœå‹™ (`bet.service.ts`) - ä½¿ç”¨ signals
- âœ… ç·šç´¢æœå‹™ (`clue.service.ts`) - ä½¿ç”¨ signals
- âœ… ç®¡ç†æœå‹™ (`admin.service.ts`) - ä½¿ç”¨ signals

### è³‡æ–™åº«

- âœ… Prisma Schema è¨­è¨ˆ (MongoDB)
- âœ… User è¡¨ï¼ˆæ”¯æ´ Google ç™»å…¥ï¼‰
- âœ… Bet è¡¨ï¼ˆuserId @unique â€” æ¯äººé™ä¸€æ³¨ï¼‰
- âœ… Clue è¡¨
- âœ… RevealConfig è¡¨

## ğŸš§ å¾…å®ŒæˆåŠŸèƒ½

### çŸ­æœŸ

1. **LINE Login æ•´åˆ**: ç›®å‰æŒ‰éˆ•å·²ä¿ç•™ä½†å°šæœªå¯¦ä½œ
2. **æª”æ¡ˆä¸Šå‚³åŠŸèƒ½**: ç·šç´¢åœ–ç‰‡ä¸Šå‚³ï¼ˆå¯ç”¨ Cloudinary / AWS S3ï¼‰
3. **å³æ™‚é€šçŸ¥**: ä½¿ç”¨ WebSocket æˆ– Server-Sent Events
4. **ä»˜æ¬¾æ•´åˆ**: ä¸²æ¥å°ç£é‡‘æµï¼ˆç¶ ç•Œã€è—æ–°ï¼‰

### é•·æœŸ

1. **å¤šèªè¨€æ”¯æ´**: i18nï¼ˆä¸­æ–‡/è‹±æ–‡ï¼‰
2. **ç›´æ’­æ•´åˆ**: YouTube Live / Twitch åµŒå…¥
3. **ä¸»é¡Œåˆ‡æ›**: æ·±è‰²/æ·ºè‰²æ¨¡å¼

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é …

1. **ç’°å¢ƒè®Šæ•¸**: çµ•å°ä¸è¦æäº¤ `.env` åˆ° Git â€” å·²é€é `.gitignore` æ’é™¤
2. **è¨­å®šåˆ†é›¢**: æ‰€æœ‰å€‹äºº ID / Email çµ±ä¸€æ”¾åœ¨ `backend/.env`ï¼ŒåŸå§‹ç¢¼ä¸­ä¸å«ç¡¬ç·¨ç¢¼
3. **Config API**: `GET /api/config` åªå›å‚³å¯å…¬é–‹è³‡æ–™ï¼ˆGoogle Client IDã€Admin Emailsï¼‰ï¼Œä¸å›å‚³å¯†ç¢¼æˆ– Secret
4. **Session Secret**: ä½¿ç”¨å¼·å¯†ç¢¼ä¸¦å®šæœŸæ›´æ›
5. **è¼¸å…¥é©—è­‰**: å¾Œç«¯å¿…é ˆé©—è­‰æ‰€æœ‰è¼¸å…¥
6. **HTTPS**: æ­£å¼ç’°å¢ƒå¿…é ˆä½¿ç”¨ HTTPS

## ğŸ‰ æ€§åˆ¥æ­æ›‰æ—¥æ¸…å–®

æ­æ›‰ç•¶å¤©è¦åšçš„äº‹:

- [ ] ç¢ºèªæ‰€æœ‰ä¸‹æ³¨ä»˜æ¬¾éƒ½å·²ç¢ºèªï¼ˆç®¡ç†å¾Œå°ï¼‰
- [ ] æº–å‚™æ­æ›‰å½±ç‰‡/é“å…·
- [ ] åœ¨ç®¡ç†å¾Œå°æ­æ›‰æ€§åˆ¥
- [ ] åŸ·è¡ŒæŠ½çåŠŸèƒ½
- [ ] å…¬å¸ƒå¾—çè€…
- [ ] çµ±è¨ˆå¥¶ç²‰éŒ¢ç¸½é¡

ç¥ä½ çš„å¯¶å¯¶æ€§åˆ¥æ´¾å°åœ“æ»¿æˆåŠŸï¼ğŸŠğŸ‘¶

---

## å¿«é€ŸæŒ‡ä»¤åƒè€ƒ

### å¾Œç«¯

```bash
cd backend
npm run dev          # å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ (port 3333)
npx prisma studio    # é–‹å•Ÿè³‡æ–™åº«ç®¡ç†ä»‹é¢
npx prisma db push   # åŒæ­¥ Schema åˆ° MongoDB
```

### å‰ç«¯

```bash
cd frontend
npm start           # å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ (port 4444)
ng build --configuration production  # å»ºç½®æ­£å¼ç‰ˆæœ¬
ng generate component components/<name>  # å»ºç«‹æ–°å…ƒä»¶
```

### éƒ¨ç½²

```bash
# å¾Œç«¯ (Railway)
railway login
railway link
railway up

# å‰ç«¯ (Vercel)
vercel
vercel --prod
```
